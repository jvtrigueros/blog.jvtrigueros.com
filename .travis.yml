sudo: false
language: ruby
rvm:
  - 2.2
cache: bundler
gemfile: src/Gemfile

script:
  - cd src/
  - bundle exec jekyll build
  - find _site/assets/ -type f -name *.png -exec convert {} -strip {} \;
  - find _site/assets/ -type f -name *.jpg -exec convert {} -sampling-factor 4:2:0 -strip -quality 85 -interlace JPEG -colorspace RGB {} \;
  - bundle exec s3_website push

branches:
  only:
    - master
